unit ex01;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Data.FMTBcd, Data.DB,
  Data.SqlExpr, FireDAC.Stan.Intf, FireDAC.Stan.Option, FireDAC.Stan.Error,
  FireDAC.UI.Intf, FireDAC.Phys.Intf, FireDAC.Stan.Def, FireDAC.Stan.Pool,
  FireDAC.Stan.Async, FireDAC.Phys, FireDAC.Phys.FB, FireDAC.Phys.FBDef,
  FireDAC.VCLUI.Wait, FireDAC.Stan.Param, FireDAC.DatS, FireDAC.DApt.Intf,
  FireDAC.DApt, Vcl.Mask, Vcl.ExtCtrls, Vcl.DBCtrls, FireDAC.Comp.DataSet,
  FireDAC.Comp.Client, FireDAC.Comp.UI, FireDAC.Phys.IBBase;

type
  TfrmCountries = class(TForm)
    lblCountry: TLabel;
    lblCapital: TLabel;
    lblContinent: TLabel;
    fdConnection: TFDConnection;
    fdTransaction: TFDTransaction;
    FDPhysFBDriverLink1: TFDPhysFBDriverLink;
    FDGUIxWaitCursor1: TFDGUIxWaitCursor;
    qCountries: TFDQuery;
    dsCountries: TDataSource;
    qCountriesCOUNTRYID: TIntegerField;
    qCountriesNAME: TStringField;
    qCountriesCAPITAL: TStringField;
    qCountriesCONTINENT: TStringField;
    qCountriesPOPULATION: TIntegerField;
    dbCountry: TDBEdit;
    dbCapital: TDBEdit;
    dbContinent: TDBEdit;
    dbnCountries: TDBNavigator;
    lblPopulation: TLabel;
    dbPopulation: TDBEdit;
    dbArea: TDBEdit;
    lblArea: TLabel;
    qCountriesAREA: TFMTBCDField;
    lblDensity: TLabel;
    dbDensity: TDBEdit;
    qCountriesDensity: TFloatField;
    rdbContinent: TRadioGroup;
    procedure FormActivate(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure qCountriesCalcFields(DataSet: TDataSet);
    procedure rdbContinentClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  frmCountries: TfrmCountries;

implementation

{$R *.dfm}

procedure TfrmCountries.FormActivate(Sender: TObject);
begin
  qCountries.Open;
end;

procedure TfrmCountries.FormClose(Sender: TObject; var Action: TCloseAction);
begin
  qCountries.Close;
end;

procedure TfrmCountries.qCountriesCalcFields(DataSet: TDataSet);
begin
  qCountriesDensity.AsFloat := qCountriesPOPULATION.AsFloat / qCountriesAREA.AsFloat;
end;

procedure TfrmCountries.rdbContinentClick(Sender: TObject);
begin
  qCountries.Close;
  qCountries.SQL.Clear;
  qCountries.SQL.Add('SELECT * FROM COUNTRIES WHERE CONTINENT = ' + #39 + rdbContinent.Items[rdbContinent.ItemIndex] + #39);
  qCountries.Open;
end;

end.
